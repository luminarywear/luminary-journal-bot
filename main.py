import asyncio
import os
import random
import hashlib
import threading
from datetime import datetime, timedelta
from aiogram import Bot, Dispatcher, Router, F
from aiogram.types import (
    Message, ReplyKeyboardMarkup, KeyboardButton
)
from aiogram.fsm.storage.memory import MemoryStorage
from aiogram.fsm.state import State, StatesGroup
from aiogram.fsm.context import FSMContext
from apscheduler.schedulers.asyncio import AsyncIOScheduler
from apscheduler.triggers.cron import CronTrigger
from dotenv import load_dotenv

# === HEALTH CHECK ===
from aiohttp import web

async def health_check(request):
    return web.Response(text="OK")

def start_health_server():
    async def run_server():
        app = web.Application()
        app.router.add_get('/health', health_check)
        runner = web.AppRunner(app)
        await runner.setup()
        port = int(os.getenv("PORT", 10000))
        site = web.TCPSite(runner, "0.0.0.0", port)
        await site.start()
        await asyncio.Event().wait()

    loop = asyncio.new_event_loop()
    asyncio.set_event_loop(loop)
    loop.run_until_complete(run_server())

threading.Thread(target=start_health_server, daemon=True).start()

# === –û–°–ù–û–í–ù–û–ô –ö–û–î ===
load_dotenv()

BOT_TOKEN = os.getenv("BOT_TOKEN")
DATABASE_URL = os.getenv("DATABASE_URL")
if not BOT_TOKEN:
    raise ValueError("BOT_TOKEN is required")
if not DATABASE_URL:
    raise ValueError("DATABASE_URL is required")

# === DATABASE ===
import asyncpg

async def init_db():
    conn = await asyncpg.connect(DATABASE_URL)
    try:
        await conn.execute("""
            CREATE TABLE IF NOT EXISTS users (
                user_id BIGINT PRIMARY KEY,
                username TEXT,
                soft_name TEXT,
                created_at TIMESTAMP DEFAULT NOW()
            )
        """)
        await conn.execute("""
            CREATE TABLE IF NOT EXISTS entries (
                id SERIAL PRIMARY KEY,
                user_id BIGINT REFERENCES users(user_id) ON DELETE CASCADE,
                text TEXT NOT NULL,
                created_at TIMESTAMP DEFAULT NOW(),
                entry_type TEXT DEFAULT 'free'
            )
        """)
        await conn.execute("""
            CREATE TABLE IF NOT EXISTS sent_affirmations (
                user_id BIGINT,
                affirmation_hash TEXT,
                sent_at TIMESTAMP DEFAULT NOW()
            )
        """)
    finally:
        await conn.close()

async def execute_query(query, *params):
    conn = await asyncpg.connect(DATABASE_URL)
    try:
        if query.strip().upper().startswith("SELECT"):
            return await conn.fetch(query, *params)
        else:
            await conn.execute(query, *params)
    finally:
        await conn.close()

# === AFFIRMATIONS: 365 –ß–Å–¢–ö–ò–• –§–†–ê–ó –° –≠–ú–û–î–ó–ò ===
AFFIRMATIONS = [
    "–Ø –µ—Å—Ç—å —Å–≤–µ—Ç, –∏ —Å–≤–µ—Ç –≤–µ–¥—ë—Ç –º–µ–Ω—è. ‚ú®",
    "–Ø –¥–æ–≤–µ—Ä—è—é –ø—É—Ç–∏, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–µ—Ä–µ–¥–æ –º–Ω–æ–π. üåø",
    "–í–æ –º–Ω–µ –∂–∏–≤—ë—Ç —Ç–∏—Ö–∞—è, —Å–∏–ª—å–Ω–∞—è –≤–µ—Ä–∞. ü§ç",
    "–Ø –≤—ã–±–∏—Ä–∞—é –ª—é–±–æ–≤—å –≤ –∫–∞–∂–¥–æ–º —Ä–µ—à–µ–Ω–∏–∏. ‚ù§Ô∏è",
    "–ú–æ—è –¥—É—à–∞ –∑–Ω–∞–µ—Ç, –∫—É–¥–∞ –∏–¥—Ç–∏. üå±",
    "–Ø –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ —ç—Ç–æ–º –º–∏—Ä–µ. üåæ",
    "–°–≤–µ—Ç –≤–Ω—É—Ç—Ä–∏ –º–µ–Ω—è —è—Ä—á–µ –ª—é–±—ã—Ö —Å–æ–º–Ω–µ–Ω–∏–π. ‚ö°Ô∏è",
    "–Ø —Ä–∞–∑—Ä–µ—à–∞—é —Å–µ–±–µ –±—ã—Ç—å —Å–æ–±–æ–π. ü§ç",
    "–ñ–∏–∑–Ω—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–µ–Ω—è –º—è–≥–∫–æ –∏ —Ç–æ—á–Ω–æ. üíö",
    "–Ø –¥—ã—à—É —Å–≤–æ–±–æ–¥–æ–π –∏ –ø–æ–∫–æ–µ–º. üåô",
    "–ú–æ—ë —Å–µ—Ä–¥—Ü–µ –æ—Ç–∫—Ä—ã—Ç–æ –¥–æ–±—Ä—É. üíõ",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é —Å–µ–±—è –ø–æ–ª–Ω–æ—Å—Ç—å—é. ü§ç",
    "–í–µ—Ä–∞ –Ω–∞–ø–æ–ª–Ω—è–µ—Ç –º–æ–∏ —à–∞–≥–∏ —Å–º—ã—Å–ª–æ–º. üåø",
    "–Ø –≤—ã–±–∏—Ä–∞—é –ø—É—Ç—å —Å–≤–µ—Ç–∞. ‚ú®",
    "–Ø –¥–æ—Å—Ç–æ–∏–Ω –ª—é–±–≤–∏ –ø—Ä–æ—Å—Ç–æ –ø–æ—Ç–æ–º—É, —á—Ç–æ —Å—É—â–µ—Å—Ç–≤—É—é. üíñ",
    "–ú–∏—Ä –æ—Ç–≤–µ—á–∞–µ—Ç –º–Ω–µ —Ç–µ–ø–ª–æ–º. üå∏",
    "–Ø —Å–ª—ã—à—É –≥–æ–ª–æ—Å —Å–≤–æ–µ–π –¥—É—à–∏. üåô",
    "–í—Å—ë –ø—Ä–∏—Ö–æ–¥–∏—Ç –∫–æ –º–Ω–µ –≤–æ–≤—Ä–µ–º—è. üçÄ",
    "–Ø –¥–æ–≤–µ—Ä—è—é —Å–≤–æ–µ–º—É –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º—É –∑–Ω–∞–Ω–∏—é. ü§ç",
    "–õ—é–±–æ–≤—å ‚Äî –º–æ–π –æ—Ä–∏–µ–Ω—Ç–∏—Ä. ‚ù§Ô∏è",
    "–Ø –∂–∏–≤—É –≤ —Å–æ–≥–ª–∞—Å–∏–∏ —Å —Å–æ–±–æ–π. üåø",
    "–°–≤–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –º–æ–∏ –º—ã—Å–ª–∏. ‚ú®",
    "–Ø –ø–æ–∑–≤–æ–ª—è—é –∂–∏–∑–Ω–∏ –±—ã—Ç—å —â–µ–¥—Ä–æ–π –∫–æ –º–Ω–µ. üíö",
    "–Ø —Å–ø–æ–∫–æ–µ–Ω –≤ –Ω–∞—Å—Ç–æ—è—â–µ–º –º–æ–º–µ–Ω—Ç–µ. üåô",
    "–ú–æ—è –≤–µ—Ä–∞ –≥–ª—É–±–æ–∫–∞ –∏ —Ç–∏—Ö–∞. ü§ç",
    "–Ø –≤—ã–±–∏—Ä–∞—é –º—è–≥–∫–æ—Å—Ç—å –≤–º–µ—Å—Ç–æ –±–æ—Ä—å–±—ã. üå∏",
    "–Ø –ø–æ–¥ –∑–∞—â–∏—Ç–æ–π –≤—ã—Å—à–µ–≥–æ –∑–∞–º—ã—Å–ª–∞. ‚òòÔ∏è",
    "–ú–æ—ë —Å–µ—Ä–¥—Ü–µ –∑–Ω–∞–µ—Ç –ø—Ä–∞–≤–¥—É. üíõ",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é –ø–µ—Ä–µ–º–µ–Ω—ã —Å –¥–æ–≤–µ—Ä–∏–µ–º. üå±",
    "–í–æ –º–Ω–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–∏–ª. ‚ö°Ô∏è",
    "–Ø –∏–¥—É —Å–≤–æ–∏–º –ø—É—Ç—ë–º. üåæ",
    "–°–≤–µ—Ç —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –º–µ–Ω—è. ‚ú®",
    "–Ø –ø–æ–∑–≤–æ–ª—è—é —Å–µ–±–µ —Ä–∞—Å—Ç–∏. üåø",
    "–ú–æ—è –∂–∏–∑–Ω—å –Ω–∞–ø–æ–ª–Ω–µ–Ω–∞ —Å–º—ã—Å–ª–æ–º. ü§ç",
    "–Ø –¥–æ–≤–µ—Ä—è—é –ø—Ä–æ—Ü–µ—Å—Å—É. üåô",
    "–õ—é–±–æ–≤—å –∂–∏–≤—ë—Ç –≤–æ –º–Ω–µ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ. üíñ",
    "–Ø —Å–ø–æ–∫–æ–µ–Ω –∏ —Å–æ–±—Ä–∞–Ω. üåø",
    "–ú–∏—Ä –±–ª–∞–≥–æ—Å–∫–ª–æ–Ω–µ–Ω –∫–æ –º–Ω–µ. üå∏",
    "–Ø –≤—ã–±–∏—Ä–∞—é –≤–µ—Ä—É –≤–º–µ—Å—Ç–æ —Å—Ç—Ä–∞—Ö–∞. ‚ú®",
    "–ú–æ—ë –¥—ã—Ö–∞–Ω–∏–µ ‚Äî —è–∫–æ—Ä—å –ø–æ–∫–æ—è. üåô",
    "–Ø –æ—Ç–∫—Ä—ã—Ç –Ω–æ–≤—ã–º —á—É–¥–µ—Å–∞–º. üçÄ",
    "–Ø —á—É–≤—Å—Ç–≤—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É –∂–∏–∑–Ω–∏. üåæ",
    "–í—Å—ë, —á—Ç–æ –º–Ω–µ –Ω—É–∂–Ω–æ, —É–∂–µ –≤–æ –º–Ω–µ. ü§ç",
    "–Ø —Ä–∞–∑—Ä–µ—à–∞—é —Å–µ–±–µ —Å–≤–µ—Ç–∏—Ç—å. ‚ö°Ô∏è",
    "–Ø –∏–¥—É —Ç—É–¥–∞, –≥–¥–µ –æ—Ç–∫–ª–∏–∫–∞–µ—Ç—Å—è —Å–µ—Ä–¥—Ü–µ. ‚ù§Ô∏è",
    "–ú–æ—è –¥—É—à–∞ –≤ –≥–∞—Ä–º–æ–Ω–∏–∏. üåø",
    "–Ø –¥–æ–≤–µ—Ä—è—é –¥–∞–∂–µ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ –Ω–µ –≤—Å—ë —è—Å–Ω–æ. üåô",
    "–õ—é–±–æ–≤—å –≤–µ–¥—ë—Ç –º–µ–Ω—è. üíö",
    "–Ø –≤—ã–±–∏—Ä–∞—é –±—ã—Ç—å –≤ –º–∏—Ä–µ —Å —Å–æ–±–æ–π. ü§ç",
    "–ú–æ–π –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Å–≤–µ—Ç —Å—Ç–∞–±–∏–ª–µ–Ω. ‚ú®",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é —Å–≤–æ—é —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å. üå∏",
    "–Ø –∂–∏–≤—É –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤–µ—Ä—ã. üåø",
    "–ñ–∏–∑–Ω—å –∑–∞–±–æ—Ç–∏—Ç—Å—è –æ–±–æ –º–Ω–µ. üíõ",
    "–Ø –º—è–≥–∫–æ –æ—Ç–ø—É—Å–∫–∞—é –∫–æ–Ω—Ç—Ä–æ–ª—å. üçÄ",
    "–ú–æ—ë —Å–µ—Ä–¥—Ü–µ —Å–ø–æ–∫–æ–π–Ω–æ. üåô",
    "–Ø —Å–ª—ã—à—É –∑–Ω–∞–∫–∏ –∂–∏–∑–Ω–∏. üåæ",
    "–Ø –Ω–∞—Ö–æ–∂—É—Å—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –º–µ—Å—Ç–µ. ‚òòÔ∏è",
    "–°–≤–µ—Ç –Ω–∞–ø–æ–ª–Ω—è–µ—Ç –º–æ–∏ –¥–µ–π—Å—Ç–≤–∏—è. ‚ú®",
    "–Ø –ø–æ–∑–≤–æ–ª—è—é –¥–æ–±—Ä—É –≤—Ö–æ–¥–∏—Ç—å –≤ –º–æ—é –∂–∏–∑–Ω—å. üíñ",
    "–Ø –≤–µ—Ä—é —Å–µ–±–µ. ü§ç",
    "–ú–æ—è —ç–Ω–µ—Ä–≥–∏—è —á–∏—Å—Ç–∞ –∏ —è—Å–Ω–∞. ‚ö°Ô∏è",
    "–Ø –≤—ã–±–∏—Ä–∞—é –ø—É—Ç—å –ª—é–±–≤–∏. ‚ù§Ô∏è",
    "–Ø –≤ –¥–æ–≤–µ—Ä–∏–∏ –∫ –∑–∞–≤—Ç—Ä–∞—à–Ω–µ–º—É –¥–Ω—é. üåô",
    "–í—Å—ë —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è –Ω–∞–∏–ª—É—á—à–∏–º –æ–±—Ä–∞–∑–æ–º. üçÄ",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é –∂–∏–∑–Ω—å —Ç–∞–∫–æ–π, –∫–∞–∫ –æ–Ω–∞ –µ—Å—Ç—å. üåø",
    "–ú–æ–π —Å–≤–µ—Ç –Ω—É–∂–µ–Ω —ç—Ç–æ–º—É –º–∏—Ä—É. ‚ú®",
    "–Ø —Å–ø–æ–∫–æ–µ–Ω –≤–Ω—É—Ç—Ä–∏. üåô",
    "–Ø –∂–∏–≤—É —Å –æ—Ç–∫—Ä—ã—Ç—ã–º —Å–µ—Ä–¥—Ü–µ–º. üíö",
    "–í–µ—Ä–∞ —É–∫—Ä–µ–ø–ª—è–µ—Ç –º–µ–Ω—è. üå±",
    "–Ø –ø–æ–∑–≤–æ–ª—è—é —Å–µ–±–µ –±—ã—Ç—å –Ω–∞—Å—Ç–æ—è—â–∏–º. ü§ç",
    "–Ø –Ω–µ—Å—É —Å–≤–µ—Ç —á–µ—Ä–µ–∑ –ø—Ä–æ—Å—Ç—ã–µ –≤–µ—â–∏. ‚ú®",
    "–ú–æ—è –∂–∏–∑–Ω—å ‚Äî –∂–∏–≤–æ–π –ø–æ—Ç–æ–∫. üåæ",
    "–Ø –¥–æ–≤–µ—Ä—è—é —Å–≤–æ–µ–º—É —Ä–∏—Ç–º—É. üåø",
    "–Ø –≤—ã–±–∏—Ä–∞—é —è—Å–Ω–æ—Å—Ç—å. üåô",
    "–õ—é–±–æ–≤—å –Ω–∞–ø–æ–ª–Ω—è–µ—Ç –º–æ–∏ –¥–Ω–∏. üíõ",
    "–Ø —É—Å—Ç–æ–π—á–∏–≤ –≤ –ª—é–±—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö. üå±",
    "–°–≤–µ—Ç –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–µ–Ω—è –∫ —Å–µ–±–µ. ‚ú®",
    "–Ø –≤ –≥–∞—Ä–º–æ–Ω–∏–∏ —Å –º–∏—Ä–æ–º. üåø",
    "–Ø –æ—Ç–ø—É—Å–∫–∞—é –≤—Å—ë –ª–∏—à–Ω–µ–µ. üçÄ",
    "–ú–æ—ë —Å–µ—Ä–¥—Ü–µ ‚Äî –º–æ–π –¥–æ–º. ‚ù§Ô∏è",
    "–Ø —á—É–≤—Å—Ç–≤—É—é –æ–ø–æ—Ä—É –≤–Ω—É—Ç—Ä–∏. üåæ",
    "–ñ–∏–∑–Ω—å –≥–æ–≤–æ—Ä–∏—Ç —Å–æ –º–Ω–æ–π –º—è–≥–∫–æ. üå∏",
    "–Ø –≤—ã–±–∏—Ä–∞—é –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –ø–æ–∫–æ–π. üåô",
    "–Ø –æ—Ç–∫—Ä—ã—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–µ. ü§ç",
    "–°–≤–µ—Ç –≤–æ –º–Ω–µ –Ω–µ–∏–∑–º–µ–Ω–µ–Ω. ‚ú®",
    "–Ø —Ä–∞–∑—Ä–µ—à–∞—é —Å–µ–±–µ –¥–æ–≤–µ—Ä—è—Ç—å. üåø",
    "–Ø –∏–¥—É –±–µ–∑ —Å–ø–µ—à–∫–∏. üåæ",
    "–ú–æ—è –≤–µ—Ä–∞ —Å–ø–æ–∫–æ–π–Ω–∞ –∏ —Å–∏–ª—å–Ω–∞. ü§ç",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é –∫–∞–∂–¥—ã–π –æ–ø—ã—Ç. üå±",
    "–Ø –∂–∏–≤—É –≤ –ª—é–±–≤–∏. üíñ",
    "–Ø —Å–ª—ã—à—É —Å–µ–±—è —è—Å–Ω–æ. üåô",
    "–Ø –ø–æ–∑–≤–æ–ª—è—é –∂–∏–∑–Ω–∏ —É–¥–∏–≤–ª—è—Ç—å –º–µ–Ω—è. üå∏",
    "–ú–æ–π –ø—É—Ç—å –±–ª–∞–≥–æ—Å–ª–æ–≤–ª—ë–Ω. ‚òòÔ∏è",
    "–Ø –≤—ã–±–∏—Ä–∞—é —Å–≤–µ—Ç –¥–∞–∂–µ –≤ —Ç–∏—à–∏–Ω–µ. ‚ú®",
    "–Ø –≤ –ª–∞–¥—É —Å —Å–æ–±–æ–π. ü§ç",
    "–Ø —á—É–≤—Å—Ç–≤—É—é —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å. üåø",
    "–õ—é–±–æ–≤—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–µ–Ω—è. üíö",
    "–Ø –¥–æ–≤–µ—Ä—è—é —Ç–µ—á–µ–Ω–∏—é –∂–∏–∑–Ω–∏. üåæ",
    "–Ø –Ω–∞—Ö–æ–∂—É –ø–æ–∫–æ–π –≤–Ω—É—Ç—Ä–∏. üåô",
    "–Ø –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω –∑–∞ —ç—Ç–æ—Ç –¥–µ–Ω—å. üå∏",
    "–ö–∞–∂–¥—ã–π –¥–µ–Ω—å —è –≤—ã–±–∏—Ä–∞—é –≤–µ—Ä—É. ‚ú®",
    "–ú–æ–π —Å–≤–µ—Ç —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≥–ª—É–±–∂–µ. üå±",
    "–Ø –∂–∏–≤—É –∏–∑ —Å–µ—Ä–¥—Ü–∞. ‚ù§Ô∏è",
    "–Ø –ø–æ–∑–≤–æ–ª—è—é —Å–µ–±–µ –∑–∞–º–µ–¥–ª—è—Ç—å—Å—è. üåø",
    "–ñ–∏–∑–Ω—å —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–µ—Ä–µ–¥–æ –º–Ω–æ–π. üåæ",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é —Å–µ–±—è –∑–¥–µ—Å—å –∏ —Å–µ–π—á–∞—Å. ü§ç",
    "–Ø –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ —Å–≤–æ—ë–º –≤—ã–±–æ—Ä–µ. ‚òòÔ∏è",
    "–ú–æ—è –≤–µ—Ä–∞ —Ç–∏—Ö–∞ –∏ —É—Å—Ç–æ–π—á–∏–≤–∞. üåô",
    "–Ø –æ—Ç–ø—É—Å–∫–∞—é —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ. üçÄ",
    "–Ø –¥–æ–≤–µ—Ä—è—é –¥–∞–∂–µ –≤ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç–∏. üåø",
    "–ú–æ–π –ø—É—Ç—å –æ—Å–≤–µ—â—ë–Ω. ‚ú®",
    "–Ø –≤—ã–±–∏—Ä–∞—é –º—è–≥–∫—É—é —Å–∏–ª—É. üå∏",
    "–Ø —á—É–≤—Å—Ç–≤—É—é —Å–≤—è–∑—å —Å –∂–∏–∑–Ω—å—é. üå±",
    "–õ—é–±–æ–≤—å –≤–µ–¥—ë—Ç –º–æ–∏ —Å–ª–æ–≤–∞. üíõ",
    "–Ø –ø–æ–∑–≤–æ–ª—è—é —Å–µ–±–µ –±—ã—Ç—å —Å–≤–µ—Ç–ª—ã–º. ‚ú®",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é –ø–æ–¥–¥–µ—Ä–∂–∫—É –º–∏—Ä–∞. ü§ç",
    "–Ø –∂–∏–≤—É –±–µ–∑ —Å–ø–µ—à–∫–∏. üåæ",
    "–í–µ—Ä–∞ –Ω–∞–ø–æ–ª–Ω—è–µ—Ç –º–æ–∏ —à–∞–≥–∏. üåø",
    "–Ø —Å–ø–æ–∫–æ–µ–Ω –≤ —Å–≤–æ—ë–º —Ü–µ–Ω—Ç—Ä–µ. üåô",
    "–Ø –¥–æ–≤–µ—Ä—è—é –≤—Ä–µ–º–µ–Ω–∏. üåô",
    "–ú–æ—è –¥—É—à–∞ –∑–Ω–∞–µ—Ç –æ—Ç–≤–µ—Ç—ã. üåô",
    "–Ø –≤—ã–±–∏—Ä–∞—é —è—Å–Ω–æ—Å—Ç—å –º—ã—Å–ª–µ–π. ‚ú®",
    "–Ø –æ—Ç–∫—Ä—ã—Ç –ª—é–±–≤–∏. ‚ù§Ô∏è",
    "–°–≤–µ—Ç –≤–Ω—É—Ç—Ä–∏ –º–µ–Ω—è —Å—Ç–∞–±–∏–ª–µ–Ω. ‚ö°Ô∏è",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é —Å–≤–æ–π –ø—É—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é. üåø",
    "–Ø –∂–∏–≤—É –≤ —Å–æ–≥–ª–∞—Å–∏–∏ —Å –∏—Å—Ç–∏–Ω–æ–π. ü§ç",
    "–ñ–∏–∑–Ω—å –¥–æ–±—Ä–∞ –∫–æ –º–Ω–µ. üå∏",
    "–Ø —á—É–≤—Å—Ç–≤—É—é –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å. üåæ",
    "–Ø –ø–æ–∑–≤–æ–ª—è—é —Å–µ–±–µ –±—ã—Ç—å –∂–∏–≤—ã–º. üå±",
    "–Ø –¥–æ–≤–µ—Ä—è—é –∫–∞–∂–¥–æ–º—É –¥–Ω—é. üåô",
    "–ú–æ—è –≤–µ—Ä–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–µ–Ω—è. üåø",
    "–Ø –≤—ã–±–∏—Ä–∞—é –±—ã—Ç—å –≤ –º–∏—Ä–µ. ü§ç",
    "–Ø —á—É–≤—Å—Ç–≤—É—é —Å–≤–µ—Ç –≤ —Ç–µ–ª–µ. ‚ú®",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é —Å–≤–æ–∏ —á—É–≤—Å—Ç–≤–∞. ‚ù§Ô∏è",
    "–Ø –∏–¥—É —Å–≤–æ–∏–º —Ç–µ–º–ø–æ–º. üåæ",
    "–õ—é–±–æ–≤—å —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç –º–µ–Ω—è. üíö",
    "–Ø –≤ –∫–æ–Ω—Ç–∞–∫—Ç–µ —Å —Å–æ–±–æ–π. üåô",
    "–Ø —Ä–∞–∑—Ä–µ—à–∞—é –∂–∏–∑–Ω–∏ –≤–µ—Å—Ç–∏ –º–µ–Ω—è. üåø",
    "–ú–æ–π —Å–≤–µ—Ç —Å–ø–æ–∫–æ–µ–Ω. ‚ú®",
    "–Ø –Ω–∞—Ö–æ–∂—É—Å—å –≤ –ø–æ—Ç–æ–∫–µ. üåæ",
    "–Ø –¥–æ–≤–µ—Ä—è—é —Å–≤–æ–µ–º—É —Å–µ—Ä–¥—Ü—É. ‚ù§Ô∏è",
    "–Ø –≤—ã–±–∏—Ä–∞—é –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ. üåô",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –¥–µ–Ω—å. üå∏",
    "–°–≤–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –º–æ–∏ —Ä–µ—à–µ–Ω–∏—è. ‚ú®",
    "–Ø –∂–∏–≤—É –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤–µ—Ä—ã. üåø",
    "–Ø –æ—Ç–∫—Ä—ã—Ç —è—Å–Ω–æ—Å—Ç–∏. ‚ú®",
    "–Ø —á—É–≤—Å—Ç–≤—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É –≤–Ω—É—Ç—Ä–∏. ü§ç",
    "–Ø –ø–æ–∑–≤–æ–ª—è—é —Å–µ–±–µ –±—ã—Ç—å –º—è–≥–∫–∏–º. üå∏",
    "–Ø –≤ –≥–∞—Ä–º–æ–Ω–∏–∏ —Å –º–æ–º–µ–Ω—Ç–æ–º. üåô",
    "–Ø –±–ª–∞–≥–æ–¥–∞—Ä—é –∂–∏–∑–Ω—å. üåæ",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é –≥–ª—É–±–∏–Ω—É —Å–≤–æ–µ–≥–æ –ø—É—Ç–∏. üåø",
    "–ú–æ—è –≤–µ—Ä–∞ —Ä–∞—Å—Ç—ë—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω–æ. üå±",
    "–Ø –∂–∏–≤—É —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –≤–∑–≥–ª—è–¥–æ–º. ‚ú®",
    "–Ø –¥–æ–≤–µ—Ä—è—é –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º—É —Å–≤–µ—Ç—É. ‚ö°Ô∏è",
    "–Ø –≤—ã–±–∏—Ä–∞—é –ª—é–±–æ–≤—å —Å–Ω–æ–≤–∞ –∏ —Å–Ω–æ–≤–∞. ‚ù§Ô∏è",
    "–Ø —á—É–≤—Å—Ç–≤—É—é –ø–æ–∫–æ–π –≤ —Ç–µ–ª–µ. üåô",
    "–ñ–∏–∑–Ω—å –Ω–µ—Å—ë—Ç –º–µ–Ω—è –±–µ—Ä–µ–∂–Ω–æ. üåø",
    "–Ø –ø–æ–∑–≤–æ–ª—è—é —Å–µ–±–µ —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å. ‚ù§Ô∏è",
    "–Ø –≤ —Å–æ–≥–ª–∞—Å–∏–∏ —Å —Å–æ–±–æ–π. ü§ç",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é —Ç–∏—à–∏–Ω—É. üåô",
    "–ú–æ–π —Å–≤–µ—Ç —è—Å–µ–Ω. ‚ú®",
    "–Ø –æ—Ç–ø—É—Å–∫–∞—é –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ. üçÄ",
    "–Ø –≤—ã–±–∏—Ä–∞—é –¥–æ–≤–µ—Ä–∏–µ. üåø",
    "–Ø –∂–∏–≤—É –≤ –Ω–∞—Å—Ç–æ—è—â–µ–º. üåô",
    "–õ—é–±–æ–≤—å –Ω–∞–ø–æ–ª–Ω—è–µ—Ç –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –≤–æ–∫—Ä—É–≥ –º–µ–Ω—è. üíö",
    "–Ø —Å–ø–æ–∫–æ–µ–Ω –≤ —Å–≤–æ–∏—Ö —Ä–µ—à–µ–Ω–∏—è—Ö. ü§ç",
    "–Ø —Å–ª—ã—à—É –º—É–¥—Ä–æ—Å—Ç—å –¥—É—à–∏. üåô",
    "–Ø —Ä–∞–∑—Ä–µ—à–∞—é —Å–µ–±–µ –±—ã—Ç—å. üåø",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é –∂–∏–∑–Ω—å –ø–æ–ª–Ω–æ—Å—Ç—å—é. üåæ",
    "–Ø –≤—ã–±–∏—Ä–∞—é –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Å–≤–µ—Ç. ‚ú®",
    "–Ø —á—É–≤—Å—Ç–≤—É—é —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å. üå±",
    "–Ø –¥–æ–≤–µ—Ä—è—é –∫–∞–∂–¥–æ–º—É —à–∞–≥—É. üåø",
    "–ú–æ—è –≤–µ—Ä–∞ ‚Äî –º–æ—è –æ–ø–æ—Ä–∞. ü§ç",
    "–Ø –∂–∏–≤—É –±–µ–∑ –±–æ—Ä—å–±—ã. üåô",
    "–Ø –æ—Ç–∫—Ä—ã—Ç –¥–æ–±—Ä—É. üíõ",
    "–Ø —á—É–≤—Å—Ç–≤—É—é —Å–≤—è–∑—å —Å –º–∏—Ä–æ–º. üåæ",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é —Å–µ–±—è —Å –ª—é–±–æ–≤—å—é. ‚ù§Ô∏è",
    "–Ø –ø–æ–∑–≤–æ–ª—è—é –∂–∏–∑–Ω–∏ –±—ã—Ç—å –ø—Ä–æ—Å—Ç–æ–π. üåø",
    "–Ø –≤ –º–∏—Ä–µ —Å –ø—Ä–æ—à–ª—ã–º. üåô",
    "–Ø –≤—ã–±–∏—Ä–∞—é —è—Å–Ω–æ—Å—Ç—å —Å–µ—Ä–¥—Ü–∞. ‚ú®",
    "–Ø –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω –∑–∞ –ø—É—Ç—å. üåæ",
    "–Ø –∂–∏–≤—É –≤ –¥–æ–≤–µ—Ä–∏–∏. üåø",
    "–°–≤–µ—Ç –Ω–∞–ø–æ–ª–Ω—è–µ—Ç –º–æ–∏ –¥–Ω–∏. ‚ö°Ô∏è",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é –Ω–∞—Å—Ç–æ—è—â–µ–µ. üåô",
    "–Ø —Å–ª—ã—à—É —Å–µ–±—è. ü§ç",
    "–Ø –≤—ã–±–∏—Ä–∞—é –º—è–≥–∫–æ—Å—Ç—å. üå∏",
    "–Ø –≤ —Å–æ–≥–ª–∞—Å–∏–∏ —Å —Ä–∏—Ç–º–æ–º –∂–∏–∑–Ω–∏. üåæ",
    "–Ø –ø–æ–∑–≤–æ–ª—è—é —Å–µ–±–µ –∑–∞–º–µ–¥–ª–∏—Ç—å—Å—è. üåô",
    "–Ø –∂–∏–≤—É –∏–∑ –ª—é–±–≤–∏. ‚ù§Ô∏è",
    "–Ø –¥–æ–≤–µ—Ä—è—é –¥–∞–∂–µ —Ç–∏—à–∏–Ω–µ. üåô",
    "–ú–æ–π –ø—É—Ç—å —Å–≤–µ—Ç–µ–ª. ‚ú®",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é –ø–æ–¥–¥–µ—Ä–∂–∫—É. ü§ç",
    "–Ø —á—É–≤—Å—Ç–≤—É—é –ø–æ–∫–æ–π. üåø",
    "–Ø –æ—Ç–∫—Ä—ã—Ç –Ω–æ–≤–æ–º—É –¥–Ω—é. üå∏",
    "–Ø –≤—ã–±–∏—Ä–∞—é –≤–µ—Ä—É –≤ —Å–µ–±—è. ‚ú®",
    "–Ø –∂–∏–≤—É —Å —è—Å–Ω—ã–º –Ω–∞–º–µ—Ä–µ–Ω–∏–µ–º. üåô",
    "–õ—é–±–æ–≤—å –Ω–∞–ø–æ–ª–Ω—è–µ—Ç –º–æ–∏ –º—ã—Å–ª–∏. üíö",
    "–Ø –¥–æ–≤–µ—Ä—è—é –∂–∏–∑–Ω–∏. üåø",
    "–Ø –≤ –≥–∞—Ä–º–æ–Ω–∏–∏ —Å —Å–æ–±–æ–π. ü§ç",
    "–Ø –±–ª–∞–≥–æ–¥–∞—Ä—é —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç. üå∏",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é —Å–≤–µ—Ç –≤ –∫–∞–∂–¥–æ–º –¥–Ω–µ. ‚ú®",
    "–ú–æ—è –≤–µ—Ä–∞ —Å–ø–æ–∫–æ–π–Ω–∞. üåô",
    "–Ø –∂–∏–≤—É –≤ —Å–æ–≥–ª–∞—Å–∏–∏ —Å –¥—É—à–æ–π. üåø",
    "–Ø –≤—ã–±–∏—Ä–∞—é –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ. üåô",
    "–Ø —á—É–≤—Å—Ç–≤—É—é —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –≤–Ω—É—Ç—Ä–∏. üå±",
    "–Ø –¥–æ–≤–µ—Ä—è—é –ø–æ—Ç–æ–∫—É. üåæ",
    "–Ø –æ—Ç–∫—Ä—ã—Ç –ª—é–±–≤–∏ –º–∏—Ä–∞. üíñ",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é —Å–≤–æ–π –ø—É—Ç—å. üåø",
    "–Ø –∂–∏–≤—É –±–µ–∑ –ª–∏—à–Ω–µ–≥–æ —à—É–º–∞. üåô",
    "–Ø –≤—ã–±–∏—Ä–∞—é —Ç–∏—à–∏–Ω—É —Å–µ—Ä–¥—Ü–∞. ü§ç",
    "–°–≤–µ—Ç –≤–µ–¥—ë—Ç –º–µ–Ω—è –º—è–≥–∫–æ. ‚ú®",
    "–Ø –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω –∑–∞ –æ–ø—ã—Ç. üåæ",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é —è—Å–Ω–æ—Å—Ç—å. ‚ú®",
    "–Ø –¥–æ–≤–µ—Ä—è—é —Å–≤–æ–µ–º—É –≤—ã–±–æ—Ä—É. üåø",
    "–Ø –∂–∏–≤—É –≤ –ª—é–±–≤–∏ –∫ —Å–µ–±–µ. ‚ù§Ô∏è",
    "–Ø —Å–ø–æ–∫–æ–µ–Ω –∏ —Å–æ–±—Ä–∞–Ω. üåô",
    "–Ø —Ä–∞–∑—Ä–µ—à–∞—é —Å–µ–±–µ –±—ã—Ç—å –Ω–∞—Å—Ç–æ—è—â–∏–º. üåø",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –¥–µ–Ω—å. üå∏",
    "–Ø —á—É–≤—Å—Ç–≤—É—é –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Å–≤–µ—Ç. ‚ö°Ô∏è",
    "–Ø –≤—ã–±–∏—Ä–∞—é –≤–µ—Ä—É. ‚ú®",
    "–Ø –¥–æ–≤–µ—Ä—è—é —Å–≤–æ–µ–º—É –ø—É—Ç–∏. üåæ",
    "–Ø –≤ –≥–∞—Ä–º–æ–Ω–∏–∏ —Å –º–∏—Ä–æ–º. üåø",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é –∫–∞–∂–¥—ã–π —à–∞–≥. ü§ç",
    "–Ø –∂–∏–≤—É –∏–∑ —Å–µ—Ä–¥—Ü–∞. ‚ù§Ô∏è",
    "–Ø –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω –∂–∏–∑–Ω–∏. üåæ",
    "–Ø –ø–æ–∑–≤–æ–ª—è—é —Å–µ–±–µ –ø–æ–∫–æ–π. üåô",
    "–Ø –æ—Ç–∫—Ä—ã—Ç —Å–≤–µ—Ç—É. ‚ú®",
    "–Ø –¥–æ–≤–µ—Ä—è—é —Ç–∏—à–∏–Ω–µ. üåô",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é –≥–ª—É–±–∏–Ω—É. üåø",
    "–Ø –≤—ã–±–∏—Ä–∞—é –ª—é–±–æ–≤—å. ‚ù§Ô∏è",
    "–Ø –∂–∏–≤—É –≤ —Å–æ–≥–ª–∞—Å–∏–∏. ü§ç",
    "–Ø —á—É–≤—Å—Ç–≤—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É. üåæ",
    "–Ø –¥–æ–≤–µ—Ä—è—é –Ω–∞—Å—Ç–æ—è—â–µ–º—É. üåô",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é —Å–µ–±—è. üåø",
    "–Ø –≤—ã–±–∏—Ä–∞—é —è—Å–Ω–æ—Å—Ç—å. ‚ú®",
    "–Ø —Å–ø–æ–∫–æ–µ–Ω –≤–Ω—É—Ç—Ä–∏. üåô",
    "–Ø –∂–∏–≤—É –≤ –ø–æ—Ç–æ–∫–µ. üåæ",
    "–Ø –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω –∑–∞ —Å–≤–µ—Ç. ‚ú®",
    "–Ø –¥–æ–≤–µ—Ä—è—é –∂–∏–∑–Ω–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é. üåø",
    "–Ø –≤ –º–∏—Ä–µ —Å —Å–æ–±–æ–π. ü§ç",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é –∫–∞–∂–¥—ã–π –Ω–æ–≤—ã–π –¥–µ–Ω—å. üå∏",
    "–ú–æ—è –≤–µ—Ä–∞ —É—Å—Ç–æ–π—á–∏–≤–∞. üå±",
    "–Ø –∂–∏–≤—É —Å –æ—Ç–∫—Ä—ã—Ç—ã–º —Å–µ—Ä–¥—Ü–µ–º. ‚ù§Ô∏è",
    "–Ø –≤—ã–±–∏—Ä–∞—é –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Å–≤–µ—Ç. ‚ú®",
    "–Ø –¥–æ–≤–µ—Ä—è—é —Å–≤–æ–µ–º—É –¥—ã—Ö–∞–Ω–∏—é. üåô",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é —Ç–∏—à–∏–Ω—É –∫–∞–∫ —Å–∏–ª—É. üåø",
    "–Ø —Å–ø–æ–∫–æ–µ–Ω –≤ —Å–≤–æ—ë–º —Ü–µ–Ω—Ç—Ä–µ. ü§ç",
    "–Ø –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω –∑–∞ –ø—É—Ç—å –¥—É—à–∏. üåæ",
    "–Ø –∂–∏–≤—É –≤ –¥–æ–≤–µ—Ä–∏–∏ –∫ –º–∏—Ä—É. üåø",
    "–Ø –≤—ã–±–∏—Ä–∞—é –ª—é–±–æ–≤—å –±–µ–∑ —É—Å–ª–æ–≤–∏–π. üíñ",
    "–Ø —á—É–≤—Å—Ç–≤—É—é —è—Å–Ω–æ—Å—Ç—å. ‚ú®",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é –∂–∏–∑–Ω—å. üåô",
    "–Ø –∂–∏–≤—É –≤ –≥–∞—Ä–º–æ–Ω–∏–∏. üåø",
    "–Ø –¥–æ–≤–µ—Ä—è—é –∫–∞–∂–¥–æ–º—É –º–æ–º–µ–Ω—Ç—É. ü§ç",
    "–Ø –æ—Ç–∫—Ä—ã—Ç –º—è–≥–∫–æ—Å—Ç–∏. üå∏",
    "–Ø –≤—ã–±–∏—Ä–∞—é –≤–µ—Ä—É –≤ –¥–æ–±—Ä–æ. ‚ú®",
    "–Ø —á—É–≤—Å—Ç–≤—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É —Å–≤–µ—Ç–∞. ‚ö°Ô∏è",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é —Å–≤–æ–π —Ä–∏—Ç–º. üåæ",
    "–Ø –∂–∏–≤—É –±–µ–∑ —Å–ø–µ—à–∫–∏. üåô",
    "–Ø –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω –∑–∞ –Ω–∞—Å—Ç–æ—è—â–µ–µ. üå∏",
    "–Ø –¥–æ–≤–µ—Ä—è—é —Å–≤–æ–µ–º—É —Å–µ—Ä–¥—Ü—É. ‚ù§Ô∏è",
    "–Ø –≤—ã–±–∏—Ä–∞—é –ø–æ–∫–æ–π. üåô",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é –≥–ª—É–±–∏–Ω—É —á—É–≤—Å—Ç–≤. üåø",
    "–Ø –∂–∏–≤—É –∏–∑ –ª—é–±–≤–∏. üíö",
    "–Ø —Å–ø–æ–∫–æ–µ–Ω –≤ –≤—ã–±–æ—Ä–µ. ü§ç",
    "–Ø –¥–æ–≤–µ—Ä—è—é –∂–∏–∑–Ω–∏ —Å–µ–≥–æ–¥–Ω—è. üåæ",
    "–Ø –æ—Ç–∫—Ä—ã—Ç –∏—Å—Ç–∏–Ω–µ. ‚ú®",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é —è—Å–Ω–æ—Å—Ç—å –ø—É—Ç–∏. üåô",
    "–Ø –∂–∏–≤—É –≤ —Å–≤–µ—Ç–µ. ‚ö°Ô∏è",
    "–Ø –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω –∑–∞ —Ç–∏—à–∏–Ω—É. üåô",
    "–Ø –≤—ã–±–∏—Ä–∞—é –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é –æ–ø–æ—Ä—É. üåø",
    "–Ø –¥–æ–≤–µ—Ä—è—é —Å–≤–æ–µ–º—É –∑–Ω–∞–Ω–∏—é. ü§ç",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é –∫–∞–∂–¥—ã–π –æ–ø—ã—Ç. üå±",
    "–Ø –∂–∏–≤—É —Å –≤–µ—Ä–æ–π. ‚ú®",
    "–Ø —Å–ø–æ–∫–æ–µ–Ω –∏ —Ü–µ–ª–æ—Å—Ç–µ–Ω. üåô",
    "–Ø –æ—Ç–∫—Ä—ã—Ç –ª—é–±–≤–∏. ‚ù§Ô∏è",
    "–Ø –¥–æ–≤–µ—Ä—è—é –ø—Ä–æ—Ü–µ—Å—Å—É –∂–∏–∑–Ω–∏. üåæ",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é —Å–µ–±—è –ø–æ–ª–Ω–æ—Å—Ç—å—é. ü§ç",
    "–Ø –∂–∏–≤—É –≤ —Å–æ–≥–ª–∞—Å–∏–∏ —Å –¥—É—à–æ–π. üåø",
    "–Ø –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω –∑–∞ —ç—Ç–æ—Ç –ø—É—Ç—å. üåæ",
    "–Ø –≤—ã–±–∏—Ä–∞—é —Å–≤–µ—Ç –∫–∞–∂–¥—ã–π –¥–µ–Ω—å. ‚ú®",
    "–ú–æ—è –≤–µ—Ä–∞ —Å–ø–æ–∫–æ–π–Ω–∞ –∏ —è—Å–Ω–∞. üåô",
    "–Ø –∂–∏–≤—É –≤ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–∏. ü§ç",
    "–Ø –¥–æ–≤–µ—Ä—è—é –Ω–∞—Å—Ç–æ—è—â–µ–º—É –º–æ–º–µ–Ω—Ç—É. üåø",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é –∂–∏–∑–Ω—å —Å –ª—é–±–æ–≤—å—é. ‚ù§Ô∏è",
    "–Ø —á—É–≤—Å—Ç–≤—É—é —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å —Å–≤–µ—Ç–∞. ‚ö°Ô∏è",
    "–Ø –≤—ã–±–∏—Ä–∞—é –¥–æ–≤–µ—Ä–∏–µ. üåæ",
    "–Ø –∂–∏–≤—É –±–µ–∑ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è. üåô",
    "–Ø –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω –∑–∞ –∫–∞–∂–¥—ã–π –≤–¥–æ—Ö. üåø",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é —Å–≤–æ—é –≥–ª—É–±–∏–Ω—É. üåô",
    "–Ø –¥–æ–≤–µ—Ä—è—é –∂–∏–∑–Ω–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é. üåø",
    "–Ø –æ—Ç–∫—Ä—ã—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Ç–∏—à–∏–Ω–µ. üåô",
    "–Ø –∂–∏–≤—É –≤ –≥–∞—Ä–º–æ–Ω–∏–∏ —Å –º–∏—Ä–æ–º. üåæ",
    "–Ø –≤—ã–±–∏—Ä–∞—é —è—Å–Ω–æ—Å—Ç—å —Å–µ—Ä–¥—Ü–∞. ‚ú®",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –¥–µ–Ω—å. üå∏",
    "–Ø —Å–ø–æ–∫–æ–µ–Ω –≤ —Å–µ–±–µ. ü§ç",
    "–Ø –¥–æ–≤–µ—Ä—è—é –ø—É—Ç–∏ –¥—É—à–∏. üåø",
    "–Ø –∂–∏–≤—É –∏–∑ –ª—é–±–≤–∏ –∏ –≤–µ—Ä—ã. ‚ù§Ô∏è",
    "–Ø –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω –∑–∞ —Å–≤–µ—Ç –≤–Ω—É—Ç—Ä–∏. ‚ú®",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç. üåô",
    "–Ø –≤—ã–±–∏—Ä–∞—é –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ –∏ –ø–æ–∫–æ–π. üåø",
    "–ú–æ—è –≤–µ—Ä–∞ ‚Äî –º–æ–π –æ—Ä–∏–µ–Ω—Ç–∏—Ä. ‚ú®",
    "–Ø –∂–∏–≤—É —Å –æ—Ç–∫—Ä—ã—Ç—ã–º —Å–µ—Ä–¥—Ü–µ–º. üíö",
    "–Ø –¥–æ–≤–µ—Ä—è—é –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º—É —Å–≤–µ—Ç—É. ‚ö°Ô∏è",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é –∂–∏–∑–Ω—å —Ü–µ–ª–∏–∫–æ–º. üåæ",
    "–Ø —Å–ø–æ–∫–æ–µ–Ω –∏ —è—Å–µ–Ω. üåô",
    "–Ø –≤—ã–±–∏—Ä–∞—é –º—è–≥–∫—É—é —Å–∏–ª—É. üå∏",
    "–Ø –∂–∏–≤—É –≤ –¥–æ–≤–µ—Ä–∏–∏ –∫ –º–∏—Ä—É. üåø",
    "–Ø –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω –∑–∞ –∫–∞–∂–¥—ã–π —à–∞–≥. üåæ",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é —Å–µ–±—è –∑–¥–µ—Å—å. ü§ç",
    "–Ø –¥–æ–≤–µ—Ä—è—é —Å–≤–æ–µ–º—É —Ä–∏—Ç–º—É. üåæ",
    "–Ø –∂–∏–≤—É –≤ —Å–≤–µ—Ç–µ –ª—é–±–≤–∏. üíñ",
    "–Ø –≤—ã–±–∏—Ä–∞—é –≤–µ—Ä—É –∫–∞–∂–¥—ã–π –¥–µ–Ω—å. ‚ú®",
    "–Ø —Å–ø–æ–∫–æ–µ–Ω –≤ —Ç–∏—à–∏–Ω–µ. üåô",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é –≥–ª—É–±–∏–Ω—É –ø—É—Ç–∏. üåø",
    "–Ø –¥–æ–≤–µ—Ä—è—é –∂–∏–∑–Ω–∏ –±–µ–∑ —É—Å–ª–æ–≤–∏–π. üåæ",
    "–Ø –∂–∏–≤—É –≤ —Å–æ–≥–ª–∞—Å–∏–∏ —Å —Å–æ–±–æ–π. ü§ç",
    "–Ø –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω –∑–∞ –Ω–∞—Å—Ç–æ—è—â–µ–µ. üå∏",
    "–Ø –≤—ã–±–∏—Ä–∞—é —è—Å–Ω–æ—Å—Ç—å –∏ –ø–æ–∫–æ–π. ‚ú®",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Å–≤–µ—Ç. ‚ö°Ô∏è",
    "–Ø –¥–æ–≤–µ—Ä—è—é –∫–∞–∂–¥–æ–º—É –¥–Ω—é. üåô",
    "–ú–æ—è –≤–µ—Ä–∞ —É—Å—Ç–æ–π—á–∏–≤–∞. üå±",
    "–Ø –∂–∏–≤—É —Å –ª—é–±–æ–≤—å—é. ‚ù§Ô∏è",
    "–Ø –≤—ã–±–∏—Ä–∞—é –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ. üåô",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é –ø—É—Ç—å –¥—É—à–∏. üåø",
    "–Ø —Å–ø–æ–∫–æ–µ–Ω –≤–Ω—É—Ç—Ä–∏. ü§ç",
    "–Ø –¥–æ–≤–µ—Ä—è—é –∂–∏–∑–Ω–∏ —Å–µ–π—á–∞—Å. üåæ",
    "–Ø –∂–∏–≤—É –≤ –≥–∞—Ä–º–æ–Ω–∏–∏. üåø",
    "–Ø –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω –∑–∞ —Å–≤–µ—Ç. ‚ú®",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é —ç—Ç–æ—Ç –¥–µ–Ω—å. üå∏",
    "–Ø –≤—ã–±–∏—Ä–∞—é –≤–µ—Ä—É –≤ –¥–æ–±—Ä–æ. ‚ú®",
    "–Ø –∂–∏–≤—É –∏–∑ —Å–µ—Ä–¥—Ü–∞. ‚ù§Ô∏è",
    "–Ø –¥–æ–≤–µ—Ä—è—é —Ç–∏—à–∏–Ω–µ. üåô",
    "–Ø —Å–ø–æ–∫–æ–µ–Ω –≤ –≤—ã–±–æ—Ä–µ. ü§ç",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é —Å–µ–±—è –ø–æ–ª–Ω–æ—Å—Ç—å—é. üåø",
    "–Ø –∂–∏–≤—É –≤ —Å–≤–µ—Ç–µ. ‚ö°Ô∏è",
    "–Ø –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω –∑–∞ –ø—É—Ç—å. üåæ",
    "–Ø –≤—ã–±–∏—Ä–∞—é –ª—é–±–æ–≤ love. ‚ù§Ô∏è",
    "–Ø –¥–æ–≤–µ—Ä—è—é —Å–≤–æ–µ–º—É —Å–µ—Ä–¥—Ü—É. üíö",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é –∂–∏–∑–Ω—å. üåô",
    "–Ø –∂–∏–≤—É –≤ –ø–æ–∫–æ–µ. üåø",
    "–Ø –≤—ã–±–∏—Ä–∞—é —è—Å–Ω–æ—Å—Ç—å. ‚ú®",
    "–Ø –¥–æ–≤–µ—Ä—è—é –ø—Ä–æ—Ü–µ—Å—Å—É. üåæ",
    "–Ø –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω –∑–∞ –∫–∞–∂–¥—ã–π –º–æ–º–µ–Ω—Ç. üå∏",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é –Ω–∞—Å—Ç–æ—è—â–∏–π –º–∏–≥. üåô",
    "–Ø –∂–∏–≤—É —Å –≤–µ—Ä–æ–π. üåø",
    "–Ø —Å–ø–æ–∫–æ–µ–Ω –∏ —Ü–µ–ª–æ—Å—Ç–µ–Ω. ü§ç",
    "–Ø –≤—ã–±–∏—Ä–∞—é —Å–≤–µ—Ç. ‚ú®",
    "–Ø –¥–æ–≤–µ—Ä—è—é –∂–∏–∑–Ω–∏. üåæ",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é —Å–µ–±—è. üåø",
    "–Ø –∂–∏–≤—É –≤ –ª—é–±–≤–∏ –∏ —Ç–∏—à–∏–Ω–µ. ‚ù§Ô∏è",
    "–ú–æ—è –≤–µ—Ä–∞ –≤–µ–¥—ë—Ç –º–µ–Ω—è. ‚ú®",
    "–Ø –≤—ã–±–∏—Ä–∞—é –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ –≤ –∫–∞–∂–¥–æ–º –¥–Ω–µ. üåô",
    "–Ø –¥–æ–≤–µ—Ä—è—é —Å–≤–æ–µ–º—É –ø—É—Ç–∏. üåæ",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é –≥–ª—É–±–∏–Ω—É –∂–∏–∑–Ω–∏. üåø",
    "–Ø —Å–ø–æ–∫–æ–µ–Ω –≤–Ω—É—Ç—Ä–∏ —Å–µ–±—è. ü§ç",
    "–Ø –∂–∏–≤—É –≤ –≥–∞—Ä–º–æ–Ω–∏–∏ —Å–æ —Å–≤–µ—Ç–æ–º. ‚ö°Ô∏è",
    "–Ø –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω –∑–∞ —ç—Ç–æ—Ç –æ–ø—ã—Ç. üå∏",
    "–Ø –≤—ã–±–∏—Ä–∞—é –ª—é–±–æ–≤—å —Å–Ω–æ–≤–∞. ‚ù§Ô∏è",
    "–Ø –¥–æ–≤–µ—Ä—è—é –Ω–∞—Å—Ç–æ—è—â–µ–º—É. üåô",
    "–Ø –ø—Ä–∏–Ω–∏–º–∞—é —Å–≤–µ—Ç –≤ —Å–µ–±–µ. ‚ú®",
    "–Ø –∂–∏–≤—É –∏–∑ –≤–µ—Ä—ã. üåø",
    "–Ø —Å–ø–æ–∫–æ–µ–Ω –≤ —Ç–∏—à–∏–Ω–µ —Å–µ—Ä–¥—Ü–∞. ü§ç",
    "–Ø –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω –∂–∏–∑–Ω–∏. üåæ",
    "–Ø –µ—Å—Ç—å —Å–≤–µ—Ç, –∏ —ç—Ç–æ–≥–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ. ‚ú®"
]

async def get_unique_affirmation(user_id: int):
    since = datetime.utcnow() - timedelta(days=365)
    rows = await execute_query(
        "SELECT affirmation_hash FROM sent_affirmations WHERE user_id = $1 AND sent_at > $2",
        user_id, since
    )
    used_hashes = {row["affirmation_hash"] for row in rows}
    
    for text in AFFIRMATIONS:
        hash_ = hashlib.sha256(text.encode()).hexdigest()[:16]
        if hash_ not in used_hashes:
            await execute_query(
                "INSERT INTO sent_affirmations (user_id, affirmation_hash, sent_at) VALUES ($1, $2, $3)",
                user_id, hash_, datetime.utcnow()
            )
            return text
    
    text = random.choice(AFFIRMATIONS)
    hash_ = hashlib.sha256(text.encode()).hexdigest()[:16]
    await execute_query(
        "INSERT INTO sent_affirmations (user_id, affirmation_hash, sent_at) VALUES ($1, $2, $3)",
        user_id, hash_, datetime.utcnow()
    )
    return text

# === FSM STATES ===
class JournalStates(StatesGroup):
    waiting_for_achievement = State()
    waiting_for_gratitude = State()
    waiting_for_entry = State()
    waiting_for_name = State()

# === ROUTER ===
router = Router()

def get_addressing(soft_name):
    return f"{soft_name}, " if soft_name else ""

def get_main_menu():
    return ReplyKeyboardMarkup(
        keyboard=[
            [KeyboardButton(text="üå± –î–æ–±–∞–≤–∏—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ")],
            [KeyboardButton(text="ü§ç –î–æ–±–∞–≤–∏—Ç—å –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å —Å–µ–±–µ")],
            [KeyboardButton(text="‚úçÔ∏è –î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å")],
            [KeyboardButton(text="–ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –¥—ã—Ö–∞–Ω–∏–µ –¥–Ω–µ–≤–Ω–∏–∫–∞ üå±")],
            [KeyboardButton(text="üå± –ú–æ–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è")],
            [KeyboardButton(text="ü§ç –ú–æ–∏ –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏")],
            [KeyboardButton(text="üìú –ú–æ–∏ –∑–∞–ø–∏—Å–∏")]
        ],
        resize_keyboard=True,
        one_time_keyboard=False
    )

# === START ===
@router.message(F.text == "/start")
async def cmd_start(message: Message, state: FSMContext):
    await execute_query("""
        INSERT INTO users (user_id, username)
        VALUES ($1, $2)
        ON CONFLICT (user_id) DO UPDATE 
        SET username = $2
    """, message.from_user.id, message.from_user.username)
    
    await message.answer(
        "–ü—Ä–∏–≤–µ—Ç. –≠—Ç–æ —Ç–≤–æ–π –¥–Ω–µ–≤–Ω–∏–∫ ‚Äî –º–µ—Å—Ç–æ, –≥–¥–µ –º–æ–∂–Ω–æ –±—ã—Ç—å —Å–æ–±–æ–π.\n\n"
        "–ó–¥–µ—Å—å –≤—Å—ë –æ—Ç–∫—Ä—ã—Ç–æ –¥–ª—è —Ç–µ–±—è. –í—Å–µ–≥–¥–∞.\n\n"
        "–ê —Ç–µ–ø–µ—Ä—å ‚Äî –∫–∞–∫ –º–Ω–µ –∫ —Ç–µ–±–µ –æ–±—Ä–∞—â–∞—Ç—å—Å—è?\n"
        "–ù–∞–ø–∏—à–∏ –∏–º—è, –≤ –∫–æ—Ç–æ—Ä–æ–º —Ç—ã —á—É–≤—Å—Ç–≤—É–µ—à—å —Å–µ–±—è —Å–æ–±–æ–π.\n\n"
        "–ù–∞–ø—Ä–∏–º–µ—Ä: <b>–ê–Ω—è, –õ–µ—à–∞, –ú–∞—Ä–∏–Ω–∞</b>‚Ä¶\n"
        "–ò–ª–∏ –ø—Ä–æ—Å—Ç–æ —Å–∫–∞–∂–∏ ¬´–±–µ–∑ –∏–º–µ–Ω–∏¬ª ‚Äî –∏ —è –±—É–¥—É –ø–∏—Å–∞—Ç—å —Ç–∞–∫, –±—É–¥—Ç–æ –º—ã —Å —Ç–æ–±–æ–π –Ω–∞–µ–¥–∏–Ω–µ, –Ω–æ –±–µ–∑ —Å–ª–æ–≤.",
        parse_mode="HTML"
    )
    await state.set_state(JournalStates.waiting_for_name)

@router.message(JournalStates.waiting_for_name)
async def handle_name_input(message: Message, state: FSMContext):
    text = message.text.strip()
    if text.lower() in ["–±–µ–∑ –∏–º–µ–Ω–∏", "–Ω–µ —Ö–æ—á—É", "–Ω–µ—Ç", "–Ω–∏–∫–∞–∫"]:
        soft_name = None
    else:
        soft_name = text
        
    await execute_query("UPDATE users SET soft_name = $1 WHERE user_id = $2", soft_name, message.from_user.id)
    prefix = get_addressing(soft_name)
    await state.clear()
    await message.answer(
        f"{prefix}–¥–Ω–µ–≤–Ω–∏–∫ –æ—Ç–∫—Ä—ã—Ç. üåø\n\n"
        "–¢—ã –º–æ–∂–µ—à—å –¥–æ–±–∞–≤–ª—è—Ç—å —Å—é–¥–∞ —Å–≤–æ–∏ –∑–∞–ø–∏—Å–∏, –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∏ –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏.\n"
        "–ü—Ä–æ—Å—Ç–æ –Ω–∞–∂–º–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ.",
        reply_markup=get_main_menu()
    )

# === –î–û–ë–ê–í–õ–ï–ù–ò–ï –ó–ê–ü–ò–°–ï–ô ===

@router.message(F.text == "üå± –î–æ–±–∞–≤–∏—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ")
async def add_achievement_start(message: Message, state: FSMContext):
    await state.set_state(JournalStates.waiting_for_achievement)
    await message.answer("–ù–∞–ø–∏—à–∏ —Å–≤–æ—ë –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ ‚Äî –±–æ–ª—å—à–æ–µ –∏–ª–∏ –º–∞–ª–µ–Ω—å–∫–æ–µ. üå±")

@router.message(JournalStates.waiting_for_achievement)
async def add_achievement_save(message: Message, state: FSMContext):
    text = message.text.strip()
    await execute_query(
        "INSERT INTO entries (user_id, text, entry_type) VALUES ($1, $2, 'achievement')",
        message.from_user.id, text
    )
    await state.clear()
    await message.answer("–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ. üå±", reply_markup=get_main_menu())

@router.message(F.text == "ü§ç –î–æ–±–∞–≤–∏—Ç—å –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å —Å–µ–±–µ")
async def add_gratitude_start(message: Message, state: FSMContext):
    await state.set_state(JournalStates.waiting_for_gratitude)
    await message.answer("–ù–∞–ø–∏—à–∏, –∑–∞ —á—Ç–æ —Ç—ã –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω(–∞) —Å–µ–±–µ —Å–µ–≥–æ–¥–Ω—è. ü§ç")

@router.message(JournalStates.waiting_for_gratitude)
async def add_gratitude_save(message: Message, state: FSMContext):
    text = message.text.strip()
    await execute_query(
        "INSERT INTO entries (user_id, text, entry_type) VALUES ($1, $2, 'gratitude')",
        message.from_user.id, text
    )
    await state.clear()
    await message.answer("–ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∞. ü§ç", reply_markup=get_main_menu())

@router.message(F.text == "‚úçÔ∏è –î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å")
async def add_entry_start(message: Message, state: FSMContext):
    await state.set_state(JournalStates.waiting_for_entry)
    await message.answer("–ù–∞–ø–∏—à–∏ —Å–≤–æ—é –∑–∞–ø–∏—Å—å. üíö")

@router.message(JournalStates.waiting_for_entry)
async def add_entry_save(message: Message, state: FSMContext):
    text = message.text.strip()
    await execute_query(
        "INSERT INTO entries (user_id, text, entry_type) VALUES ($1, $2, 'free')",
        message.from_user.id, text
    )
    await state.clear()
    await message.answer("–ó–∞–ø–∏—Å–∞–Ω–æ. ‚ú®", reply_markup=get_main_menu())

# === –ü–†–û–°–ú–û–¢–† –ó–ê–ü–ò–°–ï–ô ===

@router.message(F.text == "üå± –ú–æ–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è")
async def show_achievements(message: Message):
    rows = await execute_query("""
        SELECT text FROM entries 
        WHERE user_id = $1 AND entry_type = 'achievement'
        ORDER BY created_at DESC
    """, message.from_user.id)
    if not rows:
        await message.answer("–≠—Ç–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∂–¥—ë—Ç —Ç–≤–æ–∏ —Å–ª–æ–≤–∞.\n–ö–æ–≥–¥–∞ –∑–∞—Ö–æ—á–µ—à—å ‚Äî –ø—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏. ü§ç")
        return
    entries = "\n\n".join(f"‚Ä¢ {row['text']}" for row in reversed(rows))
    await message.answer(f"–¢–≤–æ–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è:\n\n{entries}")

@router.message(F.text == "ü§ç –ú–æ–∏ –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏")
async def show_gratitudes(message: Message):
    rows = await execute_query("""
        SELECT text FROM entries 
        WHERE user_id = $1 AND entry_type = 'gratitude'
        ORDER BY created_at DESC
    """, message.from_user.id)
    if not rows:
        await message.answer("–≠—Ç–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∂–¥—ë—Ç —Ç–≤–æ–∏ —Å–ª–æ–≤–∞.\n–ö–æ–≥–¥–∞ –∑–∞—Ö–æ—á–µ—à—å ‚Äî –ø—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏. ü§ç")
        return
    entries = "\n\n".join(f"‚Ä¢ {row['text']}" for row in reversed(rows))
    await message.answer(f"–¢–≤–æ–∏ –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏:\n\n{entries}")

@router.message(F.text == "üìú –ú–æ–∏ –∑–∞–ø–∏—Å–∏")
async def show_entries(message: Message):
    rows = await execute_query("""
        SELECT text FROM entries 
        WHERE user_id = $1 AND entry_type = 'free'
        ORDER BY created_at DESC
    """, message.from_user.id)
    if not rows:
        await message.answer("–≠—Ç–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∂–¥—ë—Ç —Ç–≤–æ–∏ —Å–ª–æ–≤–∞.\n–ö–æ–≥–¥–∞ –∑–∞—Ö–æ—á–µ—à—å ‚Äî –ø—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏. ü§ç")
        return
    entries = "\n\n".join(f"‚Ä¢ {row['text']}" for row in reversed(rows))
    await message.answer(f"–¢–≤–æ–∏ –∑–∞–ø–∏—Å–∏:\n\n{entries}")

# === –£–î–ê–õ–ï–ù–ò–ï ===

@router.message(F.text == "/delete_all")
async def delete_all_start(message: Message):
    kb = ReplyKeyboardMarkup(
        keyboard=[[KeyboardButton(text="–î–∞, —É–¥–∞–ª–∏—Ç—å –≤—Å—ë")]],
        resize_keyboard=True,
        one_time_keyboard=True
    )
    await message.answer(
        "–¢—ã —Ö–æ—á–µ—à—å —É–¥–∞–ª–∏—Ç—å –≤—Å–µ —Å–≤–æ–∏ –∑–∞–ø–∏—Å–∏ –∏–∑ –¥–Ω–µ–≤–Ω–∏–∫–∞?\n\n"
        "–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å. –¢–≤–æ–∏ —Å–ª–æ–≤–∞ –∏—Å—á–µ–∑–Ω—É—Ç –Ω–∞–≤—Å–µ–≥–¥–∞.\n\n"
        "–ï—Å–ª–∏ —Ç—ã —É–≤–µ—Ä–µ–Ω(–∞) ‚Äî –Ω–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ.",
        reply_markup=kb
    )

@router.message(F.text == "–î–∞, —É–¥–∞–ª–∏—Ç—å –≤—Å—ë")
async def delete_all_confirm(message: Message):
    await execute_query("DELETE FROM entries WHERE user_id = $1", message.from_user.id)
    await execute_query(
        "UPDATE users SET soft_name = NULL WHERE user_id = $1",
        message.from_user.id
    )
    await message.answer(
        "–í—Å–µ —Ç–≤–æ–∏ –∑–∞–ø–∏—Å–∏ —É–¥–∞–ª–µ–Ω—ã. ü§ç\n\n"
        "–ï—Å–ª–∏ –∑–∞—Ö–æ—á–µ—à—å –Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ ‚Äî –ø—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏ —Å—é–¥–∞.\n"
        "–î–Ω–µ–≤–Ω–∏–∫ –≤—Å–µ–≥–¥–∞ –æ—Ç–∫—Ä—ã—Ç.",
        reply_markup=get_main_menu()
    )

# === –ë–õ–ê–ì–û–î–ê–†–ù–û–°–¢–¨ ===
@router.message(F.text == "–ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –¥—ã—Ö–∞–Ω–∏–µ –¥–Ω–µ–≤–Ω–∏–∫–∞ üå±")
async def support_journal(message: Message):
    await message.answer(
        "–ï—Å–ª–∏ –¥–Ω–µ–≤–Ω–∏–∫ —Å—Ç–∞–ª —Ç–µ–±–µ –¥–æ—Ä–æ–≥ ‚Äî —Ç—ã –º–æ–∂–µ—à—å –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å –µ–≥–æ.\n\n"
        "–≠—Ç–æ –Ω–µ –ø–ª–∞—Ç–∞ –∑–∞ –¥–æ—Å—Ç—É–ø ‚Äî –¥–æ—Å—Ç—É–ø –≤—Å–µ–≥–¥–∞ –æ—Ç–∫—Ä—ã—Ç.\n"
        "–≠—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–∫–∞–∑–∞—Ç—å ¬´–±–ª–∞–≥–æ–¥–∞—Ä—é¬ª –∏ –ø–æ–º–æ—á—å –µ–º—É –∂–∏—Ç—å.\n\n"
        "üëâ <a href='https://tbank.ru/cf/59baQBY0btD'>–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç—ë–ø–ª—ã–µ –æ–±–Ω–∏–º–∞—à–∫–∏</a>\n\n"
        "–°–ø–∞—Å–∏–±–æ, —á—Ç–æ —Ç—ã –∑–¥–µ—Å—å ü§ç",
        parse_mode="HTML"
    )

# === –ï–ñ–ï–ú–ï–°–Ø–ß–ù–û–ï –ù–ê–ü–û–ú–ò–ù–ê–ù–ò–ï ===
async def send_monthly_gratitude(bot: Bot):
    now = datetime.utcnow()
    users = await execute_query("SELECT user_id FROM users")
    for user in users:
        try:
            await bot.send_message(
                user["user_id"],
                "–¢—ã –∑–¥–µ—Å—å —É–∂–µ —Ü–µ–ª—ã–π –º–µ—Å—è—Ü. üíõ\n\n"
                "–ï—Å–ª–∏ –¥–Ω–µ–≤–Ω–∏–∫ —Å—Ç–∞–ª —Ç–µ–±–µ –¥–æ—Ä–æ–≥ ‚Äî —Ç—ã –º–æ–∂–µ—à—å –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å –µ–≥–æ.\n"
                "–≠—Ç–æ –Ω–µ –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç—å, –∞ —Ç—ë–ø–ª—ã–µ –æ–±–Ω–∏–º–∞—à–∫–∏ –¥–ª—è –∞–≤—Ç–æ—Ä–∞.\n\n"
                "üëâ <a href='https://tbank.ru/cf/59baQBY0btD'>–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∏—Ö –º–æ–∂–Ω–æ –∑–¥–µ—Å—å</a>",
                parse_mode="HTML"
            )
        except Exception:
            pass

# === –ï–ñ–ï–î–ù–ï–í–ù–´–ï –ê–§–§–ò–†–ú–ê–¶–ò–ò ===
async def send_daily_affirmation(bot: Bot):
    now = datetime.utcnow()
    users = await execute_query("SELECT user_id FROM users")
    for user in users:
        try:
            text = await get_unique_affirmation(user["user_id"])
            await bot.send_message(user["user_id"], text)
        except Exception:
            pass

# === SCHEDULER ===
def setup_scheduler(bot: Bot):
    scheduler = AsyncIOScheduler(timezone=os.getenv("TIMEZONE", "Europe/Moscow"))
    scheduler.add_job(
        send_daily_affirmation,
        CronTrigger(hour=8, minute=0),
        args=[bot]
    )
    scheduler.add_job(
        send_monthly_gratitude,
        CronTrigger(day=1, hour=9, minute=0),
        args=[bot]
    )
    scheduler.start()

# === MAIN ===
async def main():
    await init_db()
    bot = Bot(token=BOT_TOKEN)
    dp = Dispatcher(storage=MemoryStorage())
    dp.include_router(router)
    setup_scheduler(bot)
    await dp.start_polling(bot)

if __name__ == "__main__":
    asyncio.run(main())